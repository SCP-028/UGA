%% example
initial_state =[1e-30 77 88.7 1e-30 5 1e-30 1e-30 1e-30 1e-30 11200 1e-30];

[T, YY1] =ode45('odesong',[0 1000],initial_state);

%%  Calculate the reaction rate

y = YY1(end,:)

 % citrate = CS - ACO2 - ACLY
 % - ((1.48 * 11.3360529 * y(1)) / (47 + y(1))) 
 AcCoA1 = ((69 * 13.2815118 * y(2) * y(3)) /((64.8 + y(2)) * (33 + y(3))))
         + ((1.9 * 0.7508832 * y(4) * (15 -y(1) )) / ((73 +  y(4)) * (11 + (15 - y(1) ))))
         - ((167 * 5.3787853 * y(6) * y(1)) / ((5.9 + y(6)) * (5 + y(1) ))) 
       
Citrate = ((167 * 5.3787853 * y(6) * y(1)) / ((5.9 + y(6)) * (5 + y(1))))
          +((1.1 * 12.5295931 * y(8)) / (120 + y(8)) )
          - ((5.3 * 12.5295931 * y(7)) / (480 + y(7) ))
          - ((2.2* 5.9057259 * y(7)) / (78 + y(7)))
        % isocitrate = ACO2 - IDH2
 Isocitrate = ((5.3 * 12.5295931 * y(7))/(480 + y(7)) )
        -((1.1 * 12.5295931 * y(8))/(120 + y(8)) )
        - ((30 * 92.8854856 * y(8) * y(3)) / ((2400 + y(8)) * (80 + y(3))))
        % alpha-KG = IDH2 - OGDH
 AlphaKG = ((30 * 92.8854856 * y(8) * y(3)) / ((2400 + y(8)) * (80 + y(3))))
          - ((30 * 13.7951864 * y(9) * y(3)) / ((4000 + y(9)) * (80 + y(3))))
        % OXa = OGDH + PC - CS
 OXa = ((30 * 13.7951864 * y(9) * y(3)) / ((4000 + y(9)) * (80 + y(3)))) 
        + ((60 * 48.5013029 * y(2) * y(10)) / ((220 + y(2)) * (3000 + y(10))))
        - ((167 * 5.3787853 * y(6) * y(1)) / ((5.9 + y(6)) * (5 + y(1))))
        % Ac-CoA2 = ACLY + ACSS2 - ACACA - HMGCS1 - KAT2A - ACOT12
 AcCoA2 = ((2.2* 5.9057259 * y(7)) / (78 + y(7)))
        + ((1.9 * 14.7159301 * y(4) * (15 - y(11))) / ((73 + y(4)) * (11 + (15 - y(11)))))
        - ((2 * 10.1 * y(11) * 1.3937241 * y(10)) / ((34 + y(11)) * (2100 + y(10))))
        - ((0.041 * 26.2653794 * y(11) * y(11)) / ((14 + y(11)) * (14 + y(11))))
        - ((0.011 * 3.4616622 *y(11))/(6.7+y(11))) 
        - ((7.26 * 21.4535639 * y(11)) / (500 + y(11)))
        % acetate = SLC16A3 + HDAC1 + HDAC2 + HDAC3 + ACOT13 + ACOT12 - ACSS1 - ACSS2
 Acetate = 88.07 + (2.8 * 9.6725321) + (2 * 1.3847293) + (1.5 * 5.3305112) 
        + ((7.26 * 21.4535639 * y(11)) / (500 + y(11))) 
        - ((1.9 * 0.7508832 * y(4) * (15 - y(1))) / ((73 + y(4)) * (11 + (15 - y(1)))))
        - ((1.9 * 14.7159301 * y(4) * (15 - y(11))) / ((73 + y(4)) * (11 + (15 - y(11)))))
        % NAD = v_NAD - PDHA1 - IDH2 - OGDH
        % + ((1.48 * 11.3360529 * y(1)) / (47 + y(1)))
NAD = ((0.20844 - (0.0012 * y(3))) / 85) 
        - ((69 * 13.2815118 * y(2) * y(3)) / ((64.8 + y(2)) * (33 + y(3))))
        - ((30 * 92.8854856 * y(8) * y(3)) / ((2400 + y(8)) * (80 + y(3)))) 
        - ((30 * 13.7951864 * y(9) * y(3)) / ((4000 + y(9)) * (80 + y(3))))

        
        
% aa= [AcCoA1 77 NAD Acetate AcCoA1 OXa Citrate Isocitrate AlphaKG 12000 AcCoA2]


% plot(T,YY1(:,1),'-',T,YY1(:,4),'*',T,YY1(:,5),'+',T,YY1(:,6),'.')
